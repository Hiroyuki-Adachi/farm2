import"universalify";import e from"graceful-fs";import{e as r,_ as o}from"../_/18dbf7ba.js";import n from"path";import t from"./mkdirs/index.js";import"process";import"os";import"../_/7cd95132.js";import"buffer";import{_ as c,a as s}from"../_/adb4351b.js";import i from"./copy/index.js";import m from"fs";import"assert";import y from"./remove/index.js";import f from"./empty/index.js";import p from"./ensure/index.js";import"jsonfile";import S from"./json/index.js";import a from"./move/index.js";import v from"./output/index.js";var d={};const u=e;const l=n;const j=c.copySync;const D=y.removeSync;const E=t.mkdirsSync;const b=s;function moveSync(e,r,o){o=o||{};const n=o.overwrite||o.clobber||false;e=l.resolve(e);r=l.resolve(r);if(e===r)return u.accessSync(e);if(isSrcSubdir(e,r))throw new Error(`Cannot move '${e}' into itself '${r}'.`);E(l.dirname(r));tryRenameSync();function tryRenameSync(){if(n)try{return u.renameSync(e,r)}catch(t){if("ENOTEMPTY"===t.code||"EEXIST"===t.code||"EPERM"===t.code){D(r);o.overwrite=false;return moveSync(e,r,o)}if("EXDEV"!==t.code)throw t;return moveSyncAcrossDevice(e,r,n)}else try{u.linkSync(e,r);return u.unlinkSync(e)}catch(o){if("EXDEV"===o.code||"EISDIR"===o.code||"EPERM"===o.code||"ENOTSUP"===o.code)return moveSyncAcrossDevice(e,r,n);throw o}}}function moveSyncAcrossDevice(e,r,o){const n=u.statSync(e);return n.isDirectory()?moveDirSyncAcrossDevice(e,r,o):moveFileSyncAcrossDevice(e,r,o)}function moveFileSyncAcrossDevice(e,r,o){const n=64*1024;const t=b(n);const c=o?"w":"wx";const s=u.openSync(e,"r");const i=u.fstatSync(s);const m=u.openSync(r,c,i.mode);let y=0;while(y<i.size){const e=u.readSync(s,t,0,n,y);u.writeSync(m,t,0,e);y+=e}u.closeSync(s);u.closeSync(m);return u.unlinkSync(e)}function moveDirSyncAcrossDevice(e,r,o){const n={overwrite:false};if(o){D(r);tryCopySync()}else tryCopySync();function tryCopySync(){j(e,r,n);return D(e)}}function isSrcSubdir(e,r){try{return u.statSync(e).isDirectory()&&e!==r&&r.indexOf(e)>-1&&r.split(l.dirname(e)+l.sep)[1].split(l.sep)[0]===l.basename(e)}catch(e){return false}}d={moveSync:moveSync};var w=d;var x={};x=Object.assign({},r,c,i,f,p,S,t,w,a,v,o,y);const h=m;Object.getOwnPropertyDescriptor(h,"promises")&&Object.defineProperty(x,"promises",{get(){return h.promises}});var A=x;const O=x.promises;export default A;export{O as promises};

