import{b as e,d as t}from"../../_/8dc3f476.js";import{d as r}from"../../_/4a7b19f3.js";import{p as o}from"../../_/e0803811.js";import n from"./url.js";import"../../_/8ddf35de.js";import"../../_/a421dfba.js";import"../../_/57403c48.js";import"../../_/633ae550.js";import"../../_/cb95b980.js";import"../../_/0545670c.js";import"../../_/3fe460d2.js";import"../../_/c5b352d6.js";var a={},s=false;var i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$5(){if(s)return a;s=true;a.fetch=isFunction(i.fetch)&&isFunction(i.ReadableStream);a.writableStream=isFunction(i.WritableStream);a.abortController=isFunction(i.AbortController);var e;function getXHR(){if(void 0!==e)return e;if(i.XMLHttpRequest){e=new i.XMLHttpRequest;try{e.open("GET",i.XDomainRequest?"/":"https://example.com")}catch(t){e=null}}else e=null;return e}function checkTypeSupport(e){var t=getXHR();if(!t)return false;try{t.responseType=e;return t.responseType===e}catch(e){}return false}a.arraybuffer=a.fetch||checkTypeSupport("arraybuffer");a.msstream=!a.fetch&&checkTypeSupport("ms-stream");a.mozchunkedarraybuffer=!a.fetch&&checkTypeSupport("moz-chunked-arraybuffer");a.overrideMimeType=a.fetch||!!getXHR()&&isFunction(getXHR().overrideMimeType);function isFunction(e){return"function"===typeof e}e=null;return a}var u={},d=false;var c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$4(){if(d)return u;d=true;var n=e.Buffer;var a=o;var s=dew$5();var i=t();var f=r();var l=u.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var p=u.IncomingMessage=function(e,t,r,o){var i=this||c;f.Readable.call(i);i._mode=r;i.headers={};i.rawHeaders=[];i.trailers={};i.rawTrailers=[];i.on("end",(function(){a.nextTick((function(){i.emit("close")}))}));if("fetch"===r){i._fetchResponse=t;i.url=t.url;i.statusCode=t.status;i.statusMessage=t.statusText;t.headers.forEach((function(e,t){i.headers[t.toLowerCase()]=e;i.rawHeaders.push(t,e)}));if(s.writableStream){var u=new WritableStream({write:function(e){o(false);return new Promise((function(t,r){i._destroyed?r():i.push(n.from(e))?t():i._resumeFetch=t}))},close:function(){o(true);i._destroyed||i.push(null)},abort:function(e){o(true);i._destroyed||i.emit("error",e)}});try{t.body.pipeTo(u).catch((function(e){o(true);i._destroyed||i.emit("error",e)}));return}catch(m){}}var d=t.body.getReader();function read(){d.read().then((function(e){if(!i._destroyed){o(e.done);if(e.done)i.push(null);else{i.push(n.from(e.value));read()}}})).catch((function(e){o(true);i._destroyed||i.emit("error",e)}))}read()}else{i._xhr=e;i._pos=0;i.url=e.responseURL;i.statusCode=e.status;i.statusMessage=e.statusText;var l=e.getAllResponseHeaders().split(/\r?\n/);l.forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var r=t[1].toLowerCase();if("set-cookie"===r){void 0===i.headers[r]&&(i.headers[r]=[]);i.headers[r].push(t[2])}else void 0!==i.headers[r]?i.headers[r]+=", "+t[2]:i.headers[r]=t[2];i.rawHeaders.push(t[1],t[2])}}));i._charset="x-user-defined";if(!s.overrideMimeType){var p=i.rawHeaders["mime-type"];if(p){var h=p.match(/;\s*charset=([^;])(;|$)/);h&&(i._charset=h[1].toLowerCase())}i._charset||(i._charset="utf-8")}}};i(p,f.Readable);p.prototype._read=function(){var e=this||c;var t=e._resumeFetch;if(t){e._resumeFetch=null;t()}};p.prototype._onXHRProgress=function(e){var t=this||c;var r=t._xhr;var o=null;switch(t._mode){case"text":o=r.responseText;if(o.length>t._pos){var a=o.substr(t._pos);if("x-user-defined"===t._charset){var s=n.alloc(a.length);for(var i=0;i<a.length;i++)s[i]=255&a.charCodeAt(i);t.push(s)}else t.push(a,t._charset);t._pos=o.length}break;case"arraybuffer":if(r.readyState!==l.DONE||!r.response)break;o=r.response;t.push(n.from(new Uint8Array(o)));break;case"moz-chunked-arraybuffer":o=r.response;if(r.readyState!==l.LOADING||!o)break;t.push(n.from(new Uint8Array(o)));break;case"ms-stream":o=r.response;if(r.readyState!==l.LOADING)break;var u=new c.MSStreamReader;u.onprogress=function(){if(u.result.byteLength>t._pos){t.push(n.from(new Uint8Array(u.result.slice(t._pos))));t._pos=u.result.byteLength}};u.onload=function(){e(true);t.push(null)};u.readAsArrayBuffer(o);break}if(t._xhr.readyState===l.DONE&&"ms-stream"!==t._mode){e(true);t.push(null)}};return u}var f={},l=false;var p="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$3(){if(l)return f;l=true;var n=e.Buffer;var a=o;var s=dew$5();var i=t();var u=dew$4();var d=r();var c=u.IncomingMessage;var h=u.readyStates;function decideMode(e,t){return s.fetch&&t?"fetch":s.mozchunkedarraybuffer?"moz-chunked-arraybuffer":s.msstream?"ms-stream":s.arraybuffer&&e?"arraybuffer":"text"}var m=f=function(e){var t=this||p;d.Writable.call(t);t._opts=e;t._body=[];t._headers={};e.auth&&t.setHeader("Authorization","Basic "+n.from(e.auth).toString("base64"));Object.keys(e.headers).forEach((function(r){t.setHeader(r,e.headers[r])}));var r;var o=true;if("disable-fetch"===e.mode||"requestTimeout"in e&&!s.abortController){o=false;r=true}else if("prefer-streaming"===e.mode)r=false;else if("allow-wrong-content-type"===e.mode)r=!s.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");r=true}t._mode=decideMode(r,o);t._fetchTimer=null;t._socketTimeout=null;t._socketTimer=null;t.on("finish",(function(){t._onFinish()}))};i(m,d.Writable);m.prototype.setHeader=function(e,t){var r=this||p;var o=e.toLowerCase();-1===v.indexOf(o)&&(r._headers[o]={name:e,value:t})};m.prototype.getHeader=function(e){var t=(this||p)._headers[e.toLowerCase()];return t?t.value:null};m.prototype.removeHeader=function(e){var t=this||p;delete t._headers[e.toLowerCase()]};m.prototype._onFinish=function(){var e=this||p;if(!e._destroyed){var t=e._opts;"timeout"in t&&0!==t.timeout&&e.setTimeout(t.timeout);var r=e._headers;var o=null;"GET"!==t.method&&"HEAD"!==t.method&&(o=new Blob(e._body,{type:(r["content-type"]||{}).value||""}));var n=[];Object.keys(r).forEach((function(e){var t=r[e].name;var o=r[e].value;Array.isArray(o)?o.forEach((function(e){n.push([t,e])})):n.push([t,o])}));if("fetch"===e._mode){var i=null;if(s.abortController){var u=new AbortController;i=u.signal;e._fetchAbortController=u;"requestTimeout"in t&&0!==t.requestTimeout&&(e._fetchTimer=p.setTimeout((function(){e.emit("requestTimeout");e._fetchAbortController&&e._fetchAbortController.abort()}),t.requestTimeout))}p.fetch(e._opts.url,{method:e._opts.method,headers:n,body:o||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:i}).then((function(t){e._fetchResponse=t;e._resetTimers(false);e._connect()}),(function(t){e._resetTimers(true);e._destroyed||e.emit("error",t)}))}else{var d=e._xhr=new p.XMLHttpRequest;try{d.open(e._opts.method,e._opts.url,true)}catch(t){a.nextTick((function(){e.emit("error",t)}));return}"responseType"in d&&(d.responseType=e._mode);"withCredentials"in d&&(d.withCredentials=!!t.withCredentials);"text"===e._mode&&"overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined");if("requestTimeout"in t){d.timeout=t.requestTimeout;d.ontimeout=function(){e.emit("requestTimeout")}}n.forEach((function(e){d.setRequestHeader(e[0],e[1])}));e._response=null;d.onreadystatechange=function(){switch(d.readyState){case h.LOADING:case h.DONE:e._onXHRProgress();break}};"moz-chunked-arraybuffer"===e._mode&&(d.onprogress=function(){e._onXHRProgress()});d.onerror=function(){if(!e._destroyed){e._resetTimers(true);e.emit("error",new Error("XHR error"))}};try{d.send(o)}catch(t){a.nextTick((function(){e.emit("error",t)}));return}}}};function statusValid(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return false}}m.prototype._onXHRProgress=function(){var e=this||p;e._resetTimers(false);if(statusValid(e._xhr)&&!e._destroyed){e._response||e._connect();e._response._onXHRProgress(e._resetTimers.bind(e))}};m.prototype._connect=function(){var e=this||p;if(!e._destroyed){e._response=new c(e._xhr,e._fetchResponse,e._mode,e._resetTimers.bind(e));e._response.on("error",(function(t){e.emit("error",t)}));e.emit("response",e._response)}};m.prototype._write=function(e,t,r){var o=this||p;o._body.push(e);r()};m.prototype._resetTimers=function(e){var t=this||p;p.clearTimeout(t._socketTimer);t._socketTimer=null;if(e){p.clearTimeout(t._fetchTimer);t._fetchTimer=null}else t._socketTimeout&&(t._socketTimer=p.setTimeout((function(){t.emit("timeout")}),t._socketTimeout))};m.prototype.abort=m.prototype.destroy=function(e){var t=this||p;t._destroyed=true;t._resetTimers(true);t._response&&(t._response._destroyed=true);t._xhr?t._xhr.abort():t._fetchAbortController&&t._fetchAbortController.abort();e&&t.emit("error",e)};m.prototype.end=function(e,t,r){var o=this||p;if("function"===typeof e){r=e;e=void 0}d.Writable.prototype.end.call(o,e,t,r)};m.prototype.setTimeout=function(e,t){var r=this||p;t&&r.once("timeout",t);r._socketTimeout=e;r._resetTimers(false)};m.prototype.flushHeaders=function(){};m.prototype.setNoDelay=function(){};m.prototype.setSocketKeepAlive=function(){};var v=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"];return f}var h={},m=false;function dew$2(){if(m)return h;m=true;h=extend;var e=Object.prototype.hasOwnProperty;function extend(){var t={};for(var r=0;r<arguments.length;r++){var o=arguments[r];for(var n in o)e.call(o,n)&&(t[n]=o[n])}return t}return h}var v={},_=false;function dew$1(){if(_)return v;_=true;v={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"};return v}var y={},T=false;var b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew(){if(T)return y;T=true;var e=dew$3();var t=dew$4();var r=dew$2();var o=dew$1();var a=n;var s=y;s.request=function(t,o){t="string"===typeof t?a.parse(t):r(t);var n=-1===b.location.protocol.search(/^https?:$/)?"http:":"";var s=t.protocol||n;var i=t.hostname||t.host;var u=t.port;var d=t.path||"/";i&&-1!==i.indexOf(":")&&(i="["+i+"]");t.url=(i?s+"//"+i:"")+(u?":"+u:"")+d;t.method=(t.method||"GET").toUpperCase();t.headers=t.headers||{};var c=new e(t);o&&c.on("response",o);return c};s.get=function get(e,t){var r=s.request(e,t);r.end();return r};s.ClientRequest=e;s.IncomingMessage=t.IncomingMessage;s.Agent=function(){};s.Agent.defaultMaxSockets=4;s.globalAgent=new s.Agent;s.STATUS_CODES=o;s.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"];return y}const g=dew();var w=g.Agent;var R=g.ClientRequest;var C=g.IncomingMessage;var E=g.METHODS;var A=g.STATUS_CODES;var S=g.get;var k=g.globalAgent;var H=g.request;export{w as Agent,R as ClientRequest,C as IncomingMessage,E as METHODS,A as STATUS_CODES,g as default,S as get,k as globalAgent,H as request};

