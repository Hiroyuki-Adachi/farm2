var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var r={};(function(r){function isArray(e){return null!==e&&"[object Array]"===Object.prototype.toString.call(e)}function isObject(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function strictDeepEqual(e,r){if(e===r)return true;var t=Object.prototype.toString.call(e);if(t!==Object.prototype.toString.call(r))return false;if(true===isArray(e)){if(e.length!==r.length)return false;for(var n=0;n<e.length;n++)if(false===strictDeepEqual(e[n],r[n]))return false;return true}if(true===isObject(e)){var i={};for(var a in e)if(hasOwnProperty.call(e,a)){if(false===strictDeepEqual(e[a],r[a]))return false;i[a]=true}for(var s in r)if(hasOwnProperty.call(r,s)&&true!==i[s])return false;return true}return false}function isFalse(e){if(""===e||false===e||null===e)return true;if(isArray(e)&&0===e.length)return true;if(isObject(e)){for(var r in e)if(e.hasOwnProperty(r))return false;return true}return false}function objValues(e){var r=Object.keys(e);var t=[];for(var n=0;n<r.length;n++)t.push(e[r[n]]);return t}function merge(e,r){var t={};for(var n in e)t[n]=e[n];for(var i in r)t[i]=r[i];return t}var t;t="function"===typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\s*(.*)/)[1]};var n=0;var i=1;var a=2;var s=3;var u=4;var o=5;var c=6;var h=7;var l=8;var f=9;var _="EOF";var v="UnquotedIdentifier";var p="QuotedIdentifier";var y="Rbracket";var d="Rparen";var g="Comma";var m="Colon";var k="Rbrace";var x="Number";var w="Current";var b="Expref";var E="Pipe";var S="Or";var T="And";var j="EQ";var N="GT";var O="LT";var P="GTE";var I="LTE";var M="NE";var A="Flatten";var L="Star";var R="Filter";var F="Dot";var H="Not";var C="Lbrace";var D="Lbracket";var q="Lparen";var z="Literal";var B={".":F,"*":L,",":g,":":m,"{":C,"}":k,"]":y,"(":q,")":d,"@":w};var J={"<":true,">":true,"=":true,"!":true};var U={" ":true,"\t":true,"\n":true};function isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"===e}function isNum(e){return e>="0"&&e<="9"||"-"===e}function isAlphaNum(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"_"===e}function Lexer(){}Lexer.prototype={tokenize:function(r){var t=[];(this||e)._current=0;var n;var i;var a;while((this||e)._current<r.length)if(isAlpha(r[(this||e)._current])){n=(this||e)._current;i=this._consumeUnquotedIdentifier(r);t.push({type:v,value:i,start:n})}else if(void 0!==B[r[(this||e)._current]]){t.push({type:B[r[(this||e)._current]],value:r[(this||e)._current],start:(this||e)._current});(this||e)._current++}else if(isNum(r[(this||e)._current])){a=this._consumeNumber(r);t.push(a)}else if("["===r[(this||e)._current]){a=this._consumeLBracket(r);t.push(a)}else if('"'===r[(this||e)._current]){n=(this||e)._current;i=this._consumeQuotedIdentifier(r);t.push({type:p,value:i,start:n})}else if("'"===r[(this||e)._current]){n=(this||e)._current;i=this._consumeRawStringLiteral(r);t.push({type:z,value:i,start:n})}else if("`"===r[(this||e)._current]){n=(this||e)._current;var s=this._consumeLiteral(r);t.push({type:z,value:s,start:n})}else if(void 0!==J[r[(this||e)._current]])t.push(this._consumeOperator(r));else if(void 0!==U[r[(this||e)._current]])(this||e)._current++;else if("&"===r[(this||e)._current]){n=(this||e)._current;(this||e)._current++;if("&"===r[(this||e)._current]){(this||e)._current++;t.push({type:T,value:"&&",start:n})}else t.push({type:b,value:"&",start:n})}else{if("|"!==r[(this||e)._current]){var u=new Error("Unknown character:"+r[(this||e)._current]);u.name="LexerError";throw u}n=(this||e)._current;(this||e)._current++;if("|"===r[(this||e)._current]){(this||e)._current++;t.push({type:S,value:"||",start:n})}else t.push({type:E,value:"|",start:n})}return t},_consumeUnquotedIdentifier:function(r){var t=(this||e)._current;(this||e)._current++;while((this||e)._current<r.length&&isAlphaNum(r[(this||e)._current]))(this||e)._current++;return r.slice(t,(this||e)._current)},_consumeQuotedIdentifier:function(r){var t=(this||e)._current;(this||e)._current++;var n=r.length;while('"'!==r[(this||e)._current]&&(this||e)._current<n){var i=(this||e)._current;"\\"!==r[i]||"\\"!==r[i+1]&&'"'!==r[i+1]?i++:i+=2;(this||e)._current=i}(this||e)._current++;return JSON.parse(r.slice(t,(this||e)._current))},_consumeRawStringLiteral:function(r){var t=(this||e)._current;(this||e)._current++;var n=r.length;while("'"!==r[(this||e)._current]&&(this||e)._current<n){var i=(this||e)._current;"\\"!==r[i]||"\\"!==r[i+1]&&"'"!==r[i+1]?i++:i+=2;(this||e)._current=i}(this||e)._current++;var a=r.slice(t+1,(this||e)._current-1);return a.replace("\\'","'")},_consumeNumber:function(r){var t=(this||e)._current;(this||e)._current++;var n=r.length;while(isNum(r[(this||e)._current])&&(this||e)._current<n)(this||e)._current++;var i=parseInt(r.slice(t,(this||e)._current));return{type:x,value:i,start:t}},_consumeLBracket:function(r){var t=(this||e)._current;(this||e)._current++;if("?"===r[(this||e)._current]){(this||e)._current++;return{type:R,value:"[?",start:t}}if("]"===r[(this||e)._current]){(this||e)._current++;return{type:A,value:"[]",start:t}}return{type:D,value:"[",start:t}},_consumeOperator:function(r){var t=(this||e)._current;var n=r[t];(this||e)._current++;if("!"===n){if("="===r[(this||e)._current]){(this||e)._current++;return{type:M,value:"!=",start:t}}return{type:H,value:"!",start:t}}if("<"===n){if("="===r[(this||e)._current]){(this||e)._current++;return{type:I,value:"<=",start:t}}return{type:O,value:"<",start:t}}if(">"===n){if("="===r[(this||e)._current]){(this||e)._current++;return{type:P,value:">=",start:t}}return{type:N,value:">",start:t}}if("="===n&&"="===r[(this||e)._current]){(this||e)._current++;return{type:j,value:"==",start:t}}},_consumeLiteral:function(r){(this||e)._current++;var n=(this||e)._current;var i=r.length;var a;while("`"!==r[(this||e)._current]&&(this||e)._current<i){var s=(this||e)._current;"\\"!==r[s]||"\\"!==r[s+1]&&"`"!==r[s+1]?s++:s+=2;(this||e)._current=s}var u=t(r.slice(n,(this||e)._current));u=u.replace("\\`","`");a=this._looksLikeJSON(u)?JSON.parse(u):JSON.parse('"'+u+'"');(this||e)._current++;return a},_looksLikeJSON:function(e){var r='[{"';var t=["true","false","null"];var n="-0123456789";if(""===e)return false;if(r.indexOf(e[0])>=0)return true;if(t.indexOf(e)>=0)return true;if(!(n.indexOf(e[0])>=0))return false;try{JSON.parse(e);return true}catch(e){return false}}};var V={};V[_]=0;V[v]=0;V[p]=0;V[y]=0;V[d]=0;V[g]=0;V[k]=0;V[x]=0;V[w]=0;V[b]=0;V[E]=1;V[S]=2;V[T]=3;V[j]=5;V[N]=5;V[O]=5;V[P]=5;V[I]=5;V[M]=5;V[A]=9;V[L]=20;V[R]=21;V[F]=40;V[H]=45;V[C]=50;V[D]=55;V[q]=60;function Parser(){}Parser.prototype={parse:function(r){this._loadTokens(r);(this||e).index=0;var t=this.expression(0);if(this._lookahead(0)!==_){var n=this._lookaheadToken(0);var i=new Error("Unexpected token type: "+n.type+", value: "+n.value);i.name="ParserError";throw i}return t},_loadTokens:function(r){var t=new Lexer;var n=t.tokenize(r);n.push({type:_,value:"",start:r.length});(this||e).tokens=n},expression:function(e){var r=this._lookaheadToken(0);this._advance();var t=this.nud(r);var n=this._lookahead(0);while(e<V[n]){this._advance();t=this.led(n,t);n=this._lookahead(0)}return t},_lookahead:function(r){return(this||e).tokens[(this||e).index+r].type},_lookaheadToken:function(r){return(this||e).tokens[(this||e).index+r]},_advance:function(){(this||e).index++},nud:function(e){var r;var t;var n;switch(e.type){case z:return{type:"Literal",value:e.value};case v:return{type:"Field",name:e.value};case p:var i={type:"Field",name:e.value};if(this._lookahead(0)===q)throw new Error("Quoted identifier not allowed for function names.");return i;break;case H:t=this.expression(V.Not);return{type:"NotExpression",children:[t]};case L:r={type:"Identity"};t=null;t=this._lookahead(0)===y?{type:"Identity"}:this._parseProjectionRHS(V.Star);return{type:"ValueProjection",children:[r,t]};case R:return this.led(e.type,{type:"Identity"});case C:return this._parseMultiselectHash();case A:r={type:A,children:[{type:"Identity"}]};t=this._parseProjectionRHS(V.Flatten);return{type:"Projection",children:[r,t]};case D:if(this._lookahead(0)===x||this._lookahead(0)===m){t=this._parseIndexExpression();return this._projectIfSlice({type:"Identity"},t)}if(this._lookahead(0)===L&&this._lookahead(1)===y){this._advance();this._advance();t=this._parseProjectionRHS(V.Star);return{type:"Projection",children:[{type:"Identity"},t]}}return this._parseMultiselectList();break;case w:return{type:w};case b:n=this.expression(V.Expref);return{type:"ExpressionReference",children:[n]};case q:var a=[];while(this._lookahead(0)!==d){if(this._lookahead(0)===w){n={type:w};this._advance()}else n=this.expression(0);a.push(n)}this._match(d);return a[0];default:this._errorToken(e)}},led:function(e,r){var t;switch(e){case F:var n=V.Dot;if(this._lookahead(0)!==L){t=this._parseDotRHS(n);return{type:"Subexpression",children:[r,t]}}this._advance();t=this._parseProjectionRHS(n);return{type:"ValueProjection",children:[r,t]};break;case E:t=this.expression(V.Pipe);return{type:E,children:[r,t]};case S:t=this.expression(V.Or);return{type:"OrExpression",children:[r,t]};case T:t=this.expression(V.And);return{type:"AndExpression",children:[r,t]};case q:var i=r.name;var a=[];var s,u;while(this._lookahead(0)!==d){if(this._lookahead(0)===w){s={type:w};this._advance()}else s=this.expression(0);this._lookahead(0)===g&&this._match(g);a.push(s)}this._match(d);u={type:"Function",name:i,children:a};return u;case R:var o=this.expression(0);this._match(y);t=this._lookahead(0)===A?{type:"Identity"}:this._parseProjectionRHS(V.Filter);return{type:"FilterProjection",children:[r,t,o]};case A:var c={type:A,children:[r]};var h=this._parseProjectionRHS(V.Flatten);return{type:"Projection",children:[c,h]};case j:case M:case N:case P:case O:case I:return this._parseComparator(r,e);case D:var l=this._lookaheadToken(0);if(l.type===x||l.type===m){t=this._parseIndexExpression();return this._projectIfSlice(r,t)}this._match(L);this._match(y);t=this._parseProjectionRHS(V.Star);return{type:"Projection",children:[r,t]};break;default:this._errorToken(this._lookaheadToken(0))}},_match:function(e){if(this._lookahead(0)!==e){var r=this._lookaheadToken(0);var t=new Error("Expected "+e+", got: "+r.type);t.name="ParserError";throw t}this._advance()},_errorToken:function(e){var r=new Error("Invalid token ("+e.type+'): "'+e.value+'"');r.name="ParserError";throw r},_parseIndexExpression:function(){if(this._lookahead(0)===m||this._lookahead(1)===m)return this._parseSliceExpression();var e={type:"Index",value:this._lookaheadToken(0).value};this._advance();this._match(y);return e},_projectIfSlice:function(e,r){var t={type:"IndexExpression",children:[e,r]};return"Slice"===r.type?{type:"Projection",children:[t,this._parseProjectionRHS(V.Star)]}:t},_parseSliceExpression:function(){var e=[null,null,null];var r=0;var t=this._lookahead(0);while(t!==y&&r<3){if(t===m){r++;this._advance()}else{if(t!==x){var n=this._lookahead(0);var i=new Error("Syntax error, unexpected token: "+n.value+"("+n.type+")");i.name="Parsererror";throw i}e[r]=this._lookaheadToken(0).value;this._advance()}t=this._lookahead(0)}this._match(y);return{type:"Slice",children:e}},_parseComparator:function(e,r){var t=this.expression(V[r]);return{type:"Comparator",name:r,children:[e,t]}},_parseDotRHS:function(e){var r=this._lookahead(0);var t=[v,p,L];if(t.indexOf(r)>=0)return this.expression(e);if(r===D){this._match(D);return this._parseMultiselectList()}if(r===C){this._match(C);return this._parseMultiselectHash()}},_parseProjectionRHS:function(e){var r;if(V[this._lookahead(0)]<10)r={type:"Identity"};else if(this._lookahead(0)===D)r=this.expression(e);else if(this._lookahead(0)===R)r=this.expression(e);else{if(this._lookahead(0)!==F){var t=this._lookaheadToken(0);var n=new Error("Sytanx error, unexpected token: "+t.value+"("+t.type+")");n.name="ParserError";throw n}this._match(F);r=this._parseDotRHS(e)}return r},_parseMultiselectList:function(){var e=[];while(this._lookahead(0)!==y){var r=this.expression(0);e.push(r);if(this._lookahead(0)===g){this._match(g);if(this._lookahead(0)===y)throw new Error("Unexpected token Rbracket")}}this._match(y);return{type:"MultiSelectList",children:e}},_parseMultiselectHash:function(){var e=[];var r=[v,p];var t,n,i,a;for(;;){t=this._lookaheadToken(0);if(r.indexOf(t.type)<0)throw new Error("Expecting an identifier token, got: "+t.type);n=t.value;this._advance();this._match(m);i=this.expression(0);a={type:"KeyValuePair",name:n,value:i};e.push(a);if(this._lookahead(0)===g)this._match(g);else if(this._lookahead(0)===k){this._match(k);break}}return{type:"MultiSelectHash",children:e}}};function TreeInterpreter(r){(this||e).runtime=r}TreeInterpreter.prototype={search:function(e,r){return this.visit(e,r)},visit:function(r,t){var n,i,a,s,u,o,c,h,l,f;switch(r.type){case"Field":if(null===t)return null;if(isObject(t)){o=t[r.name];return void 0===o?null:o}return null;break;case"Subexpression":a=this.visit(r.children[0],t);for(f=1;f<r.children.length;f++){a=this.visit(r.children[1],a);if(null===a)return null}return a;case"IndexExpression":c=this.visit(r.children[0],t);h=this.visit(r.children[1],c);return h;case"Index":if(!isArray(t))return null;var _=r.value;_<0&&(_=t.length+_);a=t[_];void 0===a&&(a=null);return a;case"Slice":if(!isArray(t))return null;var v=r.children.slice(0);var p=this.computeSliceParams(t.length,v);var y=p[0];var d=p[1];var g=p[2];a=[];if(g>0)for(f=y;f<d;f+=g)a.push(t[f]);else for(f=y;f>d;f+=g)a.push(t[f]);return a;case"Projection":var m=this.visit(r.children[0],t);if(!isArray(m))return null;l=[];for(f=0;f<m.length;f++){i=this.visit(r.children[1],m[f]);null!==i&&l.push(i)}return l;case"ValueProjection":m=this.visit(r.children[0],t);if(!isObject(m))return null;l=[];var k=objValues(m);for(f=0;f<k.length;f++){i=this.visit(r.children[1],k[f]);null!==i&&l.push(i)}return l;case"FilterProjection":m=this.visit(r.children[0],t);if(!isArray(m))return null;var x=[];var S=[];for(f=0;f<m.length;f++){n=this.visit(r.children[2],m[f]);isFalse(n)||x.push(m[f])}for(var T=0;T<x.length;T++){i=this.visit(r.children[1],x[T]);null!==i&&S.push(i)}return S;case"Comparator":s=this.visit(r.children[0],t);u=this.visit(r.children[1],t);switch(r.name){case j:a=strictDeepEqual(s,u);break;case M:a=!strictDeepEqual(s,u);break;case N:a=s>u;break;case P:a=s>=u;break;case O:a=s<u;break;case I:a=s<=u;break;default:throw new Error("Unknown comparator: "+r.name)}return a;case A:var L=this.visit(r.children[0],t);if(!isArray(L))return null;var R=[];for(f=0;f<L.length;f++){i=L[f];isArray(i)?R.push.apply(R,i):R.push(i)}return R;case"Identity":return t;case"MultiSelectList":if(null===t)return null;l=[];for(f=0;f<r.children.length;f++)l.push(this.visit(r.children[f],t));return l;case"MultiSelectHash":if(null===t)return null;l={};var F;for(f=0;f<r.children.length;f++){F=r.children[f];l[F.name]=this.visit(F.value,t)}return l;case"OrExpression":n=this.visit(r.children[0],t);isFalse(n)&&(n=this.visit(r.children[1],t));return n;case"AndExpression":s=this.visit(r.children[0],t);return true===isFalse(s)?s:this.visit(r.children[1],t);case"NotExpression":s=this.visit(r.children[0],t);return isFalse(s);case"Literal":return r.value;case E:c=this.visit(r.children[0],t);return this.visit(r.children[1],c);case w:return t;case"Function":var H=[];for(f=0;f<r.children.length;f++)H.push(this.visit(r.children[f],t));return(this||e).runtime.callFunction(r.name,H);case"ExpressionReference":var C=r.children[0];C.jmespathType=b;return C;default:throw new Error("Unknown node type: "+r.type)}},computeSliceParams:function(e,r){var t=r[0];var n=r[1];var i=r[2];var a=[null,null,null];if(null===i)i=1;else if(0===i){var s=new Error("Invalid slice, step cannot be 0");s.name="RuntimeError";throw s}var u=i<0;t=null===t?u?e-1:0:this.capSliceRange(e,t,i);n=null===n?u?-1:e:this.capSliceRange(e,n,i);a[0]=t;a[1]=n;a[2]=i;return a},capSliceRange:function(e,r,t){if(r<0){r+=e;r<0&&(r=t<0?-1:0)}else r>=e&&(r=t<0?e-1:e);return r}};function Runtime(r){(this||e)._interpreter=r;(this||e).functionTable={abs:{_func:(this||e)._functionAbs,_signature:[{types:[n]}]},avg:{_func:(this||e)._functionAvg,_signature:[{types:[l]}]},ceil:{_func:(this||e)._functionCeil,_signature:[{types:[n]}]},contains:{_func:(this||e)._functionContains,_signature:[{types:[a,s]},{types:[i]}]},ends_with:{_func:(this||e)._functionEndsWith,_signature:[{types:[a]},{types:[a]}]},floor:{_func:(this||e)._functionFloor,_signature:[{types:[n]}]},length:{_func:(this||e)._functionLength,_signature:[{types:[a,s,u]}]},map:{_func:(this||e)._functionMap,_signature:[{types:[c]},{types:[s]}]},max:{_func:(this||e)._functionMax,_signature:[{types:[l,f]}]},merge:{_func:(this||e)._functionMerge,_signature:[{types:[u],variadic:true}]},max_by:{_func:(this||e)._functionMaxBy,_signature:[{types:[s]},{types:[c]}]},sum:{_func:(this||e)._functionSum,_signature:[{types:[l]}]},starts_with:{_func:(this||e)._functionStartsWith,_signature:[{types:[a]},{types:[a]}]},min:{_func:(this||e)._functionMin,_signature:[{types:[l,f]}]},min_by:{_func:(this||e)._functionMinBy,_signature:[{types:[s]},{types:[c]}]},type:{_func:(this||e)._functionType,_signature:[{types:[i]}]},keys:{_func:(this||e)._functionKeys,_signature:[{types:[u]}]},values:{_func:(this||e)._functionValues,_signature:[{types:[u]}]},sort:{_func:(this||e)._functionSort,_signature:[{types:[f,l]}]},sort_by:{_func:(this||e)._functionSortBy,_signature:[{types:[s]},{types:[c]}]},join:{_func:(this||e)._functionJoin,_signature:[{types:[a]},{types:[f]}]},reverse:{_func:(this||e)._functionReverse,_signature:[{types:[a,s]}]},to_array:{_func:(this||e)._functionToArray,_signature:[{types:[i]}]},to_string:{_func:(this||e)._functionToString,_signature:[{types:[i]}]},to_number:{_func:(this||e)._functionToNumber,_signature:[{types:[i]}]},not_null:{_func:(this||e)._functionNotNull,_signature:[{types:[i],variadic:true}]}}}Runtime.prototype={callFunction:function(r,t){var n=(this||e).functionTable[r];if(void 0===n)throw new Error("Unknown function: "+r+"()");this._validateArgs(r,t,n._signature);return n._func.call(this||e,t)},_validateArgs:function(e,r,t){var n;if(t[t.length-1].variadic){if(r.length<t.length){n=1===t.length?" argument":" arguments";throw new Error("ArgumentError: "+e+"() "+"takes at least"+t.length+n+" but received "+r.length)}}else if(r.length!==t.length){n=1===t.length?" argument":" arguments";throw new Error("ArgumentError: "+e+"() "+"takes "+t.length+n+" but received "+r.length)}var i;var a;var s;for(var u=0;u<t.length;u++){s=false;i=t[u].types;a=this._getTypeName(r[u]);for(var o=0;o<i.length;o++)if(this._typeMatches(a,i[o],r[u])){s=true;break}if(!s)throw new Error("TypeError: "+e+"() "+"expected argument "+(u+1)+" to be type "+i+" but received type "+a+" instead.")}},_typeMatches:function(e,r,t){if(r===i)return true;if(r!==f&&r!==l&&r!==s)return e===r;if(r===s)return e===s;if(e===s){var u;r===l?u=n:r===f&&(u=a);for(var o=0;o<t.length;o++)if(!this._typeMatches(this._getTypeName(t[o]),u,t[o]))return false;return true}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return a;case"[object Number]":return n;case"[object Array]":return s;case"[object Boolean]":return o;case"[object Null]":return h;case"[object Object]":return e.jmespathType===b?c:u}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var r=e[0];var t=e[1];return-1!==r.indexOf(t,r.length-t.length)},_functionReverse:function(e){var r=this._getTypeName(e[0]);if(r===a){var t=e[0];var n="";for(var i=t.length-1;i>=0;i--)n+=t[i];return n}var s=e[0].slice(0);s.reverse();return s},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){var r=0;var t=e[0];for(var n=0;n<t.length;n++)r+=t[n];return r/t.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return isObject(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(r){var t=[];var n=(this||e)._interpreter;var i=r[0];var a=r[1];for(var s=0;s<a.length;s++)t.push(n.visit(i,a[s]));return t},_functionMerge:function(e){var r={};for(var t=0;t<e.length;t++){var n=e[t];for(var i in n)r[i]=n[i]}return r},_functionMax:function(e){if(e[0].length>0){var r=this._getTypeName(e[0][0]);if(r===n)return Math.max.apply(Math,e[0]);var t=e[0];var i=t[0];for(var a=1;a<t.length;a++)i.localeCompare(t[a])<0&&(i=t[a]);return i}return null},_functionMin:function(e){if(e[0].length>0){var r=this._getTypeName(e[0][0]);if(r===n)return Math.min.apply(Math,e[0]);var t=e[0];var i=t[0];for(var a=1;a<t.length;a++)t[a].localeCompare(i)<0&&(i=t[a]);return i}return null},_functionSum:function(e){var r=0;var t=e[0];for(var n=0;n<t.length;n++)r+=t[n];return r},_functionType:function(e){switch(this._getTypeName(e[0])){case n:return"number";case a:return"string";case s:return"array";case u:return"object";case o:return"boolean";case c:return"expref";case h:return"null"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){var r=e[0];var t=Object.keys(r);var n=[];for(var i=0;i<t.length;i++)n.push(r[t[i]]);return n},_functionJoin:function(e){var r=e[0];var t=e[1];return t.join(r)},_functionToArray:function(e){return this._getTypeName(e[0])===s?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===a?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var r=this._getTypeName(e[0]);var t;if(r===n)return e[0];if(r===a){t=+e[0];if(!isNaN(t))return t}return null},_functionNotNull:function(e){for(var r=0;r<e.length;r++)if(this._getTypeName(e[r])!==h)return e[r];return null},_functionSort:function(e){var r=e[0].slice(0);r.sort();return r},_functionSortBy:function(r){var t=r[0].slice(0);if(0===t.length)return t;var i=(this||e)._interpreter;var s=r[1];var u=this._getTypeName(i.visit(s,t[0]));if([n,a].indexOf(u)<0)throw new Error("TypeError");var o=this||e;var c=[];for(var h=0;h<t.length;h++)c.push([h,t[h]]);c.sort((function(e,r){var t=i.visit(s,e[1]);var n=i.visit(s,r[1]);if(o._getTypeName(t)!==u)throw new Error("TypeError: expected "+u+", received "+o._getTypeName(t));if(o._getTypeName(n)!==u)throw new Error("TypeError: expected "+u+", received "+o._getTypeName(n));return t>n?1:t<n?-1:e[0]-r[0]}));for(var l=0;l<c.length;l++)t[l]=c[l][1];return t},_functionMaxBy:function(e){var r=e[1];var t=e[0];var i=this.createKeyFunction(r,[n,a]);var s=-Infinity;var u;var o;for(var c=0;c<t.length;c++){o=i(t[c]);if(o>s){s=o;u=t[c]}}return u},_functionMinBy:function(e){var r=e[1];var t=e[0];var i=this.createKeyFunction(r,[n,a]);var s=Infinity;var u;var o;for(var c=0;c<t.length;c++){o=i(t[c]);if(o<s){s=o;u=t[c]}}return u},createKeyFunction:function(r,t){var n=this||e;var i=(this||e)._interpreter;var keyFunc=function(e){var a=i.visit(r,e);if(t.indexOf(n._getTypeName(a))<0){var s="TypeError: expected one of "+t+", received "+n._getTypeName(a);throw new Error(s)}return a};return keyFunc}};function compile(e){var r=new Parser;var t=r.parse(e);return t}function tokenize(e){var r=new Lexer;return r.tokenize(e)}function search(e,r){var t=new Parser;var n=new Runtime;var i=new TreeInterpreter(n);n._interpreter=i;var a=t.parse(r);return i.search(a,e)}r.tokenize=tokenize;r.compile=compile;r.search=search;r.strictDeepEqual=strictDeepEqual})(r);const t=r.tokenize,n=r.compile,i=r.search,a=r.strictDeepEqual;export default r;export{n as compile,i as search,a as strictDeepEqual,t as tokenize};

