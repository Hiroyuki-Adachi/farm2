<h1>作業一覧</h1>

<%= select_tag(:month, options_for_select(@months, @month), {:onChange => "change_month(this);", class: "form-control"}) %>
<script type="text/javascript">
  function change_month(sender)
  {
    if(sender.value == "") {
      document.location.href = "<%= works_path %>";
    } else {
      document.location.href = "<%= works_path %>?month=" + sender.value;
    }
  }
</script>
<% if @works.count > 0 %>
<table class="table table-sm">
  <tr>
    <th>作業日</th>
    <th>時刻</th>
    <th>分類</th>
    <th>内容</th>
    <th>人数</th>
    <th>工数</th>
  </tr>
<% @works.each do |work| %>
  <tr style="<%= work.tr_style %>">
    <td><%=h work.worked_at %></td>
    <td><%=h work.work_time %></td>
    <td><%=h work.genre_name %></td>
    <td><%=h link_to(work.name, {action: :show, id: work, page: @page, month: @month}) %></td>
    <td class="numeric"><%=h @count_workers[work.id] || 0 %></td>
    <td class="numeric"><%=h @sum_hours[work.id] || 0 %></td>
  </tr>
<% end %>
</table>
<%= paginate(@works) %>
<% end %>
<div class="btn-toolbar">
  <div class="btn-group mr-2">
    <%= link_to 'CSV出力', works_path(format: :csv), class: "btn btn-primary" %>
  </div>
  <div class="btn-group mr-2">
    <%= button_tag "戻る",  type: :button, :onclick => raw("javascript:location.href = '" + menu_index_path + "';"), class: "btn btn-default" %>
  </div>
</div>
