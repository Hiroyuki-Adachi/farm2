<h1>作業日報(作業機械)登録</h1>
<%= error_print(@work) %>
<%= form_for(@work, url: {action: :update }, html: {method: :put}) do |f| %>
<%= render(:partial => 'show_work', :locals => {:f => f}) %>

<h2>機械・オペレーター</h2>
<% if @machines.count == 0 || @results.count == 0  %>
<span>作業機械または作業者が登録されていません。</span>
<% else %>
<table>
  <thead>
    <tr>
      <th>作業者</th>
      <% @machines.each do |machine| %>
        <th><%= machine.name %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @results.each do |result| %>
    <tr>
      <td><%= result.worker.name + "(#{result.worker.home.name})" %></td>
        <% @machines.each do |machine| %>
          <% machine_result = result.machine_results.where(machine_id: machine).first %>
          <td><%= number_field_tag "machine_hours[#{machine.id.to_s}][#{result.id}]", machine_result ? machine_result.hours : 0, {step:0.5, min: 0, max: 99} %></td>
      <% end %>
    </tr>
    <% end %>
  </tbody>
</table>
<% end %>
<br />
  <%= f.submit '登録', :name => 'regist_machines' %>
  <%= f.submit '戻る', :name => 'cancel' %>
<% end %>
