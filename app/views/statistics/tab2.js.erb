document.getElementById("tab").innerHTML = "<%= escape_javascript(render(partial: "tab2")) %>";
const ctx = document.getElementById("chart").getContext('2d');
const chart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: <%= @total_all.map {|ta| ta[0] }.to_json.html_safe %>,
      datasets: [
            <% @categories.each_with_index do |category, i| %>
            {
              label: <%= category.name.to_json.html_safe %>,
              data: <%= @total_all.map {|ta| @total_genre[[category.genre, ta[0]]].to_f } %>,
              backgroundColor: colors[<%= i%>],
              fill: false
            },
            <% end %>
        ]
    },
    options: {
      scales: {
        xAxes: [{
          stacked: true
        }],
        yAxes: [{
          stacked: true,
          ticks: {
              beginAtZero: true,
              min: 0
          }            
        }]
      }
    }
});
