<h1>乾燥／調整管理表</h1>
<%= form_for(@drying.model, url: {controller: :dryings, action: :update}) do |fd| %>
  <div class="row">
    <div class="col-md-5 form-inline form-group">
      <div class="form-check">
        <%= fd.radio_button :drying_type_id, DryingType::COUNTRY.id, {class: "form-check-input", id: "drying_type_country"} %>
        <label for="drying_type_country" class="form-check-label h3"><%= DryingType::COUNTRY.name %></label>
      </div>
      <div class="form-check" style="margin-left:20px;">
        <%= fd.radio_button :drying_type_id, DryingType::ANOTHER.id, {class: "form-check-input", id: "drying_type_another"} %>
        <label for="drying_type_another" class="form-check-label h3"><%= DryingType::ANOTHER.name %></label>
      </div>
      <div class="form-check" style="margin-left:20px;">
        <%= fd.radio_button :drying_type_id, DryingType::SELF.id, {class: "form-check-input", id: "drying_type_self"} %>
        <label for="drying_type_self" class="form-check-label h3"><%= DryingType::SELF.name %></label>
      </div>
    </div>
    <div class="col-md-3 form-inline field form-group">
      <label class="col-form-label-lg">品種</label>
      <%= fd.select(:work_type_id, @work_types.map {|w| [w.name, w.id]}, {}, {class: "form-control dry-input"}) %>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2>乾燥</h2>
    </div>
    <div class="col-md-6">
      <h2>調整</h2>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 form-inline field form-group">
      <label class="col-form-label-lg">搬入日</label>
      <label class="col-form-label-lg"><%= @drying.carried_on %></label>
    </div>
    <div class="col-md-6 form-inline field form-group">
      <label class="col-form-label-lg">調整担当</label>
      <%= fd.select(:home_id, @homes.map {|h| [h.owner_name, h.id]}, {include_blank: true}, {class: "form-control dry-input dry-another"}) %>
    </div>
  </div>
  <div class="row">
    <div class="col-md-3 form-inline field form-group">
      <label class="col-form-label-lg">出荷日</label>
      <%= fd.date_field :shipped_on, {min: @drying.model.carried_on, required: true, class: "form-control dry-input dry-country dry-self dry-another"} %>
    </div>
  </div>
  <div class="row">
    <div class="col-md-3 form-inline field form-group">
      <label class="col-form-label-lg">水分</label>
      <%= fd.number_field :water_content, {min: 10, max: 20, step: 0.1, required: false, class: "form-control form-control dry-input dry-self dry-another", style: "width: 100px;"} %>
      <label class="col-form-label-lg">%</label>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <table class="table talbe-sm" style="width:auto;">
        <thead>
          <tr>
            <th>回数</th>
            <th>No.</th>
            <th>籾(kg)</th>
            <th>玄米(kg)</th>
            <th>水分(%)</th>
          </tr>
        </thead>
        <tbody>
          <%= fd.fields_for :drying_moths do |fm| %>
          <tr>
            <td class="numeric">
              <%= fm.object.moth_count %>
              <%= fm.hidden_field :moth_count %>
            </td>
            <td>
              <%= fm.number_field :moth_no, {class: "form-control form-control-sm dry-input dry-country", min: 0, max: 9999, style: "width: 80px;"} %>
            </td>
            <td>
              <%= fm.number_field :moth_weight, {class: "form-control form-control-sm dry-input dry-country", min: 0, max: 9999.9, step: 0.1, style: "width: 80px;"} %>
            </td>
            <td>
              <%= fm.number_field :rice_weight, {class: "form-control form-control-sm dry-input dry-country", min: 0, max: 9999.9, step: 0.1, style: "width: 80px;"} %>
            </td>
            <td>
              <%= fm.number_field :water_content, {class: "form-control form-control-sm dry-input dry-country", min: 10, max: 20, step: 0.1, style: "width: 80px;"} %>
              <%= fm.hidden_field :id %>
            </td>
          </tr>
          <% end %>
        </tbody>
        <tfoot>
          <tr>
            <th colspan="2">合計</th>
            <td class="numeric" id="sum_moth_weight"></td>
            <td class="numeric" id="sum_rice_weight"></td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
  <div class="btn-toolbar">
    <div class="btn-group mr-2">
      <%= fd.submit '登録', class: "btn btn-warning" %>
    </div>
    <div class="btn-group mr-2">
      <%= link_to '削除', @drying, {method: :delete, data: {confirm: "本当に削除してもよろしいですか?"}, class: "btn btn-danger"} %>
    </div>
    <div class="btn-group mr-2">
      <%= link_to '戻る(乾燥)', drying_path(@drying.home), class: "btn btn-outline-dark" %>
    </div>
    <% if @drying.adjustment&.home %>
      <div class="btn-group mr-2">
        <%= link_to '戻る(調整)', drying_path(@drying.adjustment.home), class: "btn btn-outline-dark" %>
      </div>
    <% end %>
  </div>
<% end %>
